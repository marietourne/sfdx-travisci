sudo: true
os: trusty
cache: false
env:
  matrix:
  - URL=https://developer.salesforce.com/media/salesforce-cli/sfdx-linux-amd64.tar.xz
  global:
    secure: btwKUEe3hFn2ph8tzFFy3T2nObC2zs4Ymu0tevpqZCMsaxDKwYLLlVB8BftdVkE+HKXOqIETfFwfFF9ad93x1TCqm2Z8MecZRp54iiqJb5zTvwdB06HuR9beBvz3aS1Th4adcTJElgNbl1LxygUZPzcT4kkvx+4r6MD9Ve7szj42L+sfkeqTLEYoIgJaDWQfs0yvt4LYUEx4TLx2oljS5IK8tUoJR3zucw7BQGPcEJGTm2ehdDXVzti+rc7OPSp9qQaJYSGVGxFL7FnOA4MDlXJ8PUyTPDUkAIPlj+7aZXYn8zpwcctbEdxDjANw0BUE6tnSZqW/STw3cTysaeEF4pHVNcLtKTzbvqgoaUPDembiE2jnvw3ndupWw+YJuQAvB6ZuI9+I3oB0zRfnq+I6wSn7f2RK+lo7CoRza2wXIAkpgj7M4lXGfXkBpXbybpMAxzNW/zTXFsESlhBXHj4SSt6T4VG3m7kkCIe2ItTZBkl5kWsEH71RPqknYHcItRlNCEMzGrp7cyZWwRfKvzzyJkPRdf6PpIT7nKMd7Ny4CYWMK0mR951abP6GqS/1MJw24oB8uv7WKB8YVgnWauZ1IhaSoUcbvUaOeLaGZ9xFFNmx8rXnki15ZtbHWReZyZGtxVou1P9rvA9IpCK+SqORp1Mu4PglVoO4HzV6tZacRmQ=
before_install:
- openssl aes-256-cbc -K $encrypted_79a2f6093848_key -iv $encrypted_79a2f6093848_iv
  -in assets/server.key.enc -out assets/server.key -d
- export SFDX_AUTOUPDATE_DISABLE=false
- export SFDX_USE_GENERIC_UNIX_KEYCHAIN=true
- export SFDX_DOMAIN_RETRY=300
- export SFDX_DISABLE_APP_HUB=true
- export SFDX_LOG_LEVEL=DEBUG
- mkdir sfdx
- wget -qO- $URL | tar xJ -C sfdx --strip-components 1
- "./sfdx/install"
- export PATH=./sfdx/$(pwd):$PATH
- sfdx --version
- sfdx plugins --core
- sfdx force:auth:jwt:grant --clientid $CONSUMERKEY --jwtkeyfile assets/server.key
  --username $USERNAME --setdefaultdevhubusername -a HubOrg
script:
- sfdx force:org:create -v HubOrg -s -f config/project-scratch-def.json -a ciorg --wait
  3
- sfdx force:org:display -u ciorg
- sfdx force:source:push -u ciorg
- sfdx force:apex:test:run -u ciorg --wait 10
- sfdx force:org:delete -u ciorg -p
